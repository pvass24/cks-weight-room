---
apiVersion: v1
kind: Namespace
metadata:
  name: security-scan
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nvidia
  namespace: security-scan
spec:
  replicas: 1
  selector:
    matchLabels:
      app: nvidia
  template:
    metadata:
      labels:
        app: nvidia
    spec:
      containers:
      - name: nvidia-container
        image: busybox:latest
        command: ["sh", "-c", "while true; do sleep 3600; done"]
        securityContext:
          privileged: true
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: cpu
  namespace: security-scan
spec:
  replicas: 1
  selector:
    matchLabels:
      app: cpu
  template:
    metadata:
      labels:
        app: cpu
    spec:
      containers:
      - name: cpu-container
        image: busybox:latest
        command: ["sh", "-c", "while true; do if [ -c /dev/mem ]; then cat /dev/mem > /dev/null 2>&1 || true; fi; sleep 10; done"]
        securityContext:
          privileged: true
        volumeMounts:
        - name: dev
          mountPath: /dev
      volumes:
      - name: dev
        hostPath:
          path: /dev
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: gpu
  namespace: security-scan
spec:
  replicas: 1
  selector:
    matchLabels:
      app: gpu
  template:
    metadata:
      labels:
        app: gpu
    spec:
      containers:
      - name: gpu-container
        image: busybox:latest
        command: ["sh", "-c", "while true; do sleep 3600; done"]
        securityContext:
          privileged: true
